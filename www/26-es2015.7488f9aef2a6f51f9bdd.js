(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{"/2d/":function(t,e,i){"use strict";i.r(e),i.d(e,"EnviomsjPageModule",(function(){return k}));var n=i("ofXK"),o=i("3Pt+"),s=i("TEn/"),a=i("tyNb"),c=i("fXoL"),r=i("UsEe"),l=i("7Vn+"),d=i("8rbx"),h=i("h7Fw"),g=i("RnZ8"),b=i("3no8"),m=i("5eqV");function u(t,e){if(1&t&&(c.bc(0,"ion-item"),c.Wb(1,"ion-icon",18),c.bc(2,"ion-label",19),c.Qc(3),c.ac(),c.ac()),2&t){const t=c.nc(2);c.Ib(3),c.Tc("",t.data.transmitter.name,"\xa0",t.data.transmitter.lastname,"")}}function f(t,e){if(1&t&&(c.bc(0,"ion-item"),c.Wb(1,"ion-icon",18),c.bc(2,"ion-label",19),c.Qc(3),c.ac(),c.ac()),2&t){const t=c.nc(2);c.Ib(3),c.Tc("",t.data.receiver.name,"\xa0",t.data.receiver.lastname,"")}}function p(t,e){if(1&t&&(c.bc(0,"div"),c.Oc(1,u,4,2,"ion-item",7),c.Oc(2,f,4,2,"ion-item",7),c.ac()),2&t){const t=c.nc();c.Ib(1),c.uc("ngIf",t.transmiterID===t.data.receiver.id),c.Ib(1),c.uc("ngIf",t.transmiterID!==t.data.receiver.id)}}function v(t,e){if(1&t&&(c.bc(0,"div",22),c.bc(1,"span"),c.Qc(2),c.ac(),c.bc(3,"div",23),c.Qc(4),c.oc(5,"date"),c.ac(),c.ac()),2&t){const t=c.nc().$implicit;c.Ib(2),c.Rc(t.message),c.Ib(2),c.Rc(c.qc(5,2,t.created_at,"short"))}}function x(t,e){if(1&t&&(c.bc(0,"div",24),c.bc(1,"div",25),c.Qc(2),c.ac(),c.bc(3,"div",26),c.Qc(4),c.oc(5,"date"),c.ac(),c.ac()),2&t){const t=c.nc().$implicit;c.Ib(2),c.Rc(t.message),c.Ib(2),c.Rc(c.qc(5,2,t.created_at,"short"))}}function I(t,e){if(1&t&&(c.bc(0,"div"),c.Oc(1,v,6,5,"div",20),c.Oc(2,x,6,5,"div",21),c.ac()),2&t){const t=e.$implicit,i=c.nc();c.Ib(1),c.uc("ngIf",i.transmiterID!==t.user_id),c.Ib(1),c.uc("ngIf",i.transmiterID===t.user_id)}}const M=[{path:"",component:(()=>{class t{constructor(t,e,i,n,o,s,a){this.router=t,this.chatS=e,this.auth=i,this.log=n,this.pObjecto=o,this.pusher=s,this.loadingService=a,this.newMsg="",this.menjs=[],this.scrollBottom=!0,this.usertk=null,this.getToken()}ngAfterViewChecked(){this.scrollToBottom()}getToken(){this.auth.gettokenLog().then(t=>{this.token=t,this.loadPage()})}scrollToBottom(){15===this.menjs.length&&(this.content.scrollToBottom(),this.scrollBottom=!0)}ngOnInit(){}loadPage(){this.getAuhUser();const t=this.pObjecto.getNavData();t&&(this.data=t.infoDt,this.chatId=t.infoDt.id,this.transmiterID=t.transferID,this.usuarioActual=t.useractual,this.pusher.channelsuscribe(this.data.id),this.pusher.init().bind("chat_event",t=>{this.updateMsg(t)}),this.loadMessages(),this.userList=this.data)}getAuhUser(){this.auth.gettokenLog().then(t=>{this.log.logdataInfData(t).subscribe(t=>{this.usertk=t})})}loadMessages(){this.loadingService.loadingPresent({spinner:"circles"}),this.data.id&&this.chatS.getchatsMSGUser(this.data.id,this.token).subscribe(t=>{this.total=t.meta,this.menjs=t.data,this.page=this.total.current_page+1,this.loadingService.loadingDismiss()},t=>{this.loadingService.loadingDismiss()})}loadData(t){setTimeout(()=>{this.data.id&&(this.menjs.length!==this.total?this.chatS.getMessageOFPages(this.data.id,this.page,this.token).subscribe(e=>{e.data.forEach(t=>{this.menjs.unshift(t)}),t.target.complete()}):t.target.disabled=!0)},1e3)}updateMsg(t){this.menjs.push(t.message),this.content.scrollToBottom(100)}enviarMsg(){this.chatId&&(this.loadingService.loadingPresent({spinner:"circles"}),this.chatS.enviarMensajeChat(this.chatId,this.transmiterID,this.newMsg,this.token).subscribe(t=>{this.chatS.getchatsMSGUser(this.chatId,this.token).subscribe(t=>{this.chatS.var.next("update messages"),setTimeout(()=>{this.content.scrollToBottom(200)})}),this.newMsg="",this.loadingService.loadingDismiss()},t=>{this.loadingService.loadingDismiss()}))}volver(){this.router.navigate(["/users/chat"])}}return t.\u0275fac=function(e){return new(e||t)(c.Vb(a.h),c.Vb(r.a),c.Vb(l.a),c.Vb(d.a),c.Vb(h.a),c.Vb(g.a),c.Vb(b.a))},t.\u0275cmp=c.Pb({type:t,selectors:[["app-enviomsj"]],viewQuery:function(t,e){var i;1&t&&c.Wc(s.s,!0),2&t&&c.Dc(i=c.kc())&&(e.content=i.first)},decls:23,vars:4,consts:[[1,"ion-toolbar-ccs"],["slot","start",2,"color","white"],[3,"click"],["name","arrow-back"],[1,"tituloInfo","logo"],[2,"color","white"],[1,"message-wrap"],[4,"ngIf"],[1,"message"],[4,"ngFor","ngForOf"],["threshold","100px","position","bottom",3,"ionInfinite"],["loadingSpinner","bubbles","loadingText","Cargando Mensajes..."],[1,"ion-align-items-center","ion-no-padding"],["size","10"],["autosize","","maxRow","4","placeholder","Escribe un mensaje",1,"msg-input",2,"background","white",3,"ngModel","ngModelChange"],["size","2",1,"send"],["expand","block",1,"msg-btn",3,"disabled","click"],["name","send-outline"],["name","person-circle-outline",2,"color","black"],[2,"margin-left","5px",";text-transform","capitalize","font-size","20px"],["class","message other-message left",4,"ngIf"],["class","message my-message right",4,"ngIf"],[1,"message","other-message","left"],[1,"ion-text-left",2,"color","#ffffff","font-size","11px","margin-right","15px"],[1,"message","my-message","right"],[1,"ion-text-right",2,"color","white","font-size","17px"],[1,"time","ion-text-right",2,"color","white","font-size","11px"]],template:function(t,e){1&t&&(c.bc(0,"ion-header"),c.bc(1,"ion-toolbar",0),c.bc(2,"ion-buttons",1),c.bc(3,"ion-button",2),c.jc("click",(function(){return e.volver()})),c.Wb(4,"ion-icon",3),c.ac(),c.ac(),c.bc(5,"ion-title",4),c.bc(6,"label",5),c.Qc(7,"MAGIN"),c.ac(),c.ac(),c.ac(),c.ac(),c.bc(8,"ion-content",6),c.bc(9,"ion-header"),c.Oc(10,p,3,2,"div",7),c.ac(),c.bc(11,"div",8),c.Oc(12,I,3,2,"div",9),c.ac(),c.bc(13,"ion-infinite-scroll",10),c.jc("ionInfinite",(function(t){return e.loadData(t)})),c.Wb(14,"ion-infinite-scroll-content",11),c.ac(),c.ac(),c.bc(15,"ion-footer"),c.bc(16,"ion-toolbar"),c.bc(17,"ion-row",12),c.bc(18,"ion-col",13),c.bc(19,"textarea",14),c.jc("ngModelChange",(function(t){return e.newMsg=t})),c.ac(),c.ac(),c.bc(20,"ion-col",15),c.bc(21,"button",16),c.jc("click",(function(){return e.enviarMsg()})),c.Wb(22,"ion-icon",17),c.ac(),c.ac(),c.ac(),c.ac(),c.ac()),2&t&&(c.Ib(10),c.uc("ngIf",e.data),c.Ib(2),c.uc("ngForOf",e.menjs),c.Ib(7),c.uc("ngModel",e.newMsg),c.Ib(2),c.uc("disabled",""===e.newMsg))},directives:[s.y,s.db,s.k,s.j,s.z,s.cb,s.s,n.m,n.l,s.B,s.C,s.w,s.P,s.r,o.c,m.a,o.p,o.s,s.E,s.F],pipes:[n.f],styles:["*[_ngcontent-%COMP%]{font-family:Proxima Nova!important}span[_ngcontent-%COMP%]{font-size:16px}.usuarios[_ngcontent-%COMP%]{background:var(--ion-color-tertiary);color:#fff}.mi-usuarios[_ngcontent-%COMP%]{background:var(--ion-color-secondary);color:#fff}.friend-img[_ngcontent-%COMP%]{position:absolute;border-radius:40px;width:40px;height:40px;box-shadow:0 0 15px rgba(0,0,0,.5)}.message[_ngcontent-%COMP%]{padding:9px!important;border-radius:10px!important;margin-bottom:8px!important;white-space:pre-wrap;display:block}.my-message.right[_ngcontent-%COMP%]{float:right;background-color:#8bc34a!important;color:#000!important;border:1px solid #d6d6d6;margin-left:35%!important}.other-message.left[_ngcontent-%COMP%]{float:left;background-color:#2196f3!important;border:1px solid #d4d4d4;margin-right:35%!important;color:#fff}.time[_ngcontent-%COMP%]{color:#dfdfdf;float:right;font-size:small;margin-left:15px}.msg-input[_ngcontent-%COMP%]{width:100%;border-radius:6px;border:1px solid #dedede;resize:none;margin-top:0;--padding-start:8px}.msg-btn[_ngcontent-%COMP%]{font-size:25px;color:#fff;background-color:transparent;margin:7px 0 0 4px}.send[_ngcontent-%COMP%]{background:#002a68;-moz-text-align-last:center;text-align-last:center;border-radius:90%;height:50px;max-width:50px!important}"]}),t})()}];let w=(()=>{class t{}return t.\u0275mod=c.Tb({type:t}),t.\u0275inj=c.Sb({factory:function(e){return new(e||t)},imports:[[a.j.forChild(M)],a.j]}),t})(),k=(()=>{class t{}return t.\u0275mod=c.Tb({type:t}),t.\u0275inj=c.Sb({factory:function(e){return new(e||t)},imports:[[s.eb,n.c,o.k,m.b,w]]}),t})()}}]);