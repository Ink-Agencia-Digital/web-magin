function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function _createClass(e,r,n){return r&&_defineProperties(e.prototype,r),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{Iy7t:function(e,r,n){"use strict";n.r(r),n.d(r,"ContenidoPageModule",(function(){return k}));var t,i,s,o=n("ofXK"),a=n("3Pt+"),c=n("TEn/"),u=n("tyNb"),l=n("mrSG"),d=n("fXoL"),h=n("7Vn+"),v=n("KB8S"),b=n("h7Fw"),f=n("3no8"),g=n("VnPy"),p=n("dNgK"),m=[{path:"",component:(t=function(){function e(r,n,t,i,s,o,a,c){var u=this;_classCallCheck(this,e),this.auth=r,this.pObjectIndex=n,this.pObjecto=t,this.loadingService=i,this.share=s,this.router=o,this.alertController=a,this.snackbar=c,this.user=null,this.id=null,this.course=null,this.order=1,this.quizHistory=[],this.cursoGeneral=null,this.isReload=!1,this.reload(),this.share.retornarQuiz().then((function(e){e&&(u.quizHistory=e)}))}return _createClass(e,[{key:"ngOnInit",value:function(){this.getToken(),this.leccion=this.pObjectIndex.getData(),this.informacion=this.pObjecto.getNavData()}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"reload",value:function(){var e=this;this.subscription=this.share.varorder.subscribe((function(r){r&&e.share.verorder().then((function(r){e.order=r+1,e.share.updateorder(r),e.loadPage()}))}))}},{key:"getToken",value:function(){var e=this;this.auth.gettokenLog().then((function(r){e.token=r,e.loadPage()}))}},{key:"loadPage",value:function(){this.index=this.pObjectIndex.getData();var e=this.pObjecto.getNavData();this.user=e.userInf,this.id=e.infoCurso.id,this.share.guardarCursoActiva(e),this.getCourse()}},{key:"getCourse",value:function(){var e=this;this.loadingService.loadingPresent({spinner:"circles"}),this.share.getCursosUsuario(this.user.id,this.token).subscribe((function(r){e.loadingService.loadingDismiss();var n=r.data.find((function(r){return r.id===e.id}));e.cursoGeneral=n,e.course=n.lessons[e.index],e.share.guardarLeccionActiva(e.course);var t=e.course.resources.find((function(r){return r.order===e.order}));t?(e.pObjectIndex.setData(e.leccion),e.pObjecto.setData(e.informacion),t.audio&&e.router.navigate(["/users/entrena/vercurso/verleccion/audio"]),t.document&&e.router.navigate(["/users/entrena/vercurso/verleccion/texto"]),t.video&&e.router.navigate(["/users/entrena/vercurso/verleccion/video"]),t.quiz&&e.router.navigate(["/users/entrena/vercurso/verleccion/quiz"])):(e.share.updateorder(null),e.quizHistory.length>0?e.share.guardarquices(e.quizHistory,e.token).subscribe((function(r){e.share.removerQuiz(),e.submit()}),(function(r){e.mostrarmensaje("Ah ocurrido un error, comuniquese con el administrador","Error","red-snackbar")})):e.submit())}))}},{key:"submit",value:function(){var e=this;this.loadingService.loadingPresent({spinner:"circles"}),this.share.obtenerLeccionesUsuario(this.course.course_id,this.token,this.user.id).subscribe((function(r){if(e.loadingService.loadingDismiss(),r.data.find((function(r){return r.id_lesson===e.course.id&&r.course_id===e.course.course_id})))e.share.guardarLeccionActiva(null),e.alertProgreso(),e.share.varLeciones.next(),e.router.navigateByUrl("/users/entrena/vercurso");else{var n={id_user:e.user.id,id_course:e.course.course_id,id_lesson:e.course.id};e.loadingService.loadingPresent({spinner:"circles"}),e.share.guardarleccion(n,e.token).subscribe((function(n){e.loadingService.loadingDismiss(),e.share.guardarLeccionActiva(null),e.cursoGeneral.lessons.length-1===r.data.length?(e.share.varExamen.next(),e.router.navigateByUrl("/users/entrena/vercurso/verleccion/examen")):(e.alertProgreso(),e.share.varLeciones.next(),e.router.navigateByUrl("/users/entrena/vercurso"))}),(function(r){e.loadingService.loadingDismiss(),e.mostrarmensaje("Ah ocurrido un error, comuniquese con el administrador","Error","red-snackbar")}))}}),(function(r){e.loadingService.loadingDismiss()}))}},{key:"alertProgreso",value:function(){return Object(l.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({header:"Felicidades",subHeader:"Terminaste la lecci\xf3n",message:"Pasa a la siguiente lecci\xf3n para incrementar tu progreso",buttons:["Acepto"]});case 2:return this.alert=e.sent,e.next=5,this.alert.present();case 5:case"end":return e.stop()}}),e,this)})))}},{key:"mostrarmensaje",value:function(e,r,n){this.snackbar.open(e,r,{duration:2e3,panelClass:[n]})}}]),e}(),t.\u0275fac=function(e){return new(e||t)(d.Vb(h.a),d.Vb(v.a),d.Vb(b.a),d.Vb(f.a),d.Vb(g.a),d.Vb(u.h),d.Vb(c.b),d.Vb(p.a))},t.\u0275cmp=d.Pb({type:t,selectors:[["app-contenido"]],decls:6,vars:0,consts:[[1,"ion-toolbar-ccs"],[1,"tituloInfo","logo"],[2,"color","white"]],template:function(e,r){1&e&&(d.bc(0,"ion-header"),d.bc(1,"ion-toolbar",0),d.bc(2,"ion-title",1),d.bc(3,"label",2),d.Qc(4,"MAGIN"),d.ac(),d.ac(),d.ac(),d.ac(),d.Wb(5,"ion-content"))},directives:[c.y,c.db,c.cb,c.s],styles:[""]}),t)}],y=((s=function e(){_classCallCheck(this,e)}).\u0275mod=d.Tb({type:s}),s.\u0275inj=d.Sb({factory:function(e){return new(e||s)},imports:[[u.j.forChild(m)],u.j]}),s),k=((i=function e(){_classCallCheck(this,e)}).\u0275mod=d.Tb({type:i}),i.\u0275inj=d.Sb({factory:function(e){return new(e||i)},imports:[[o.c,a.k,c.eb,y]]}),i)}}]);