(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{Iy7t:function(e,s,i){"use strict";i.r(s),i.d(s,"ContenidoPageModule",(function(){return m}));var t=i("ofXK"),r=i("3Pt+"),o=i("TEn/"),n=i("tyNb"),a=i("mrSG"),c=i("fXoL"),h=i("7Vn+"),u=i("KB8S"),d=i("h7Fw"),l=i("3no8"),b=i("VnPy"),g=i("dNgK");const v=[{path:"",component:(()=>{class e{constructor(e,s,i,t,r,o,n,a){this.auth=e,this.pObjectIndex=s,this.pObjecto=i,this.loadingService=t,this.share=r,this.router=o,this.alertController=n,this.snackbar=a,this.user=null,this.id=null,this.course=null,this.order=1,this.quizHistory=[],this.cursoGeneral=null,this.isReload=!1,this.reload(),this.share.retornarQuiz().then(e=>{e&&(this.quizHistory=e)})}ngOnInit(){this.getToken(),this.leccion=this.pObjectIndex.getData(),this.informacion=this.pObjecto.getNavData()}ngOnDestroy(){this.subscription.unsubscribe()}reload(){this.subscription=this.share.varorder.subscribe(e=>{e&&this.share.verorder().then(e=>{this.order=e+1,this.share.updateorder(e),this.loadPage()})})}getToken(){this.auth.gettokenLog().then(e=>{this.token=e,this.loadPage()})}loadPage(){this.index=this.pObjectIndex.getData();const e=this.pObjecto.getNavData();this.user=e.userInf,this.id=e.infoCurso.id,this.share.guardarCursoActiva(e),this.getCourse()}getCourse(){this.loadingService.loadingPresent({spinner:"circles"}),this.share.getCursosUsuario(this.user.id,this.token).subscribe(e=>{this.loadingService.loadingDismiss();let s=e.data.find(e=>e.id===this.id);this.cursoGeneral=s,this.course=s.lessons[this.index],this.share.guardarLeccionActiva(this.course);const i=this.course.resources.find(e=>e.order===this.order);i?(this.pObjectIndex.setData(this.leccion),this.pObjecto.setData(this.informacion),i.audio&&this.router.navigate(["/users/entrena/vercurso/verleccion/audio"]),i.document&&this.router.navigate(["/users/entrena/vercurso/verleccion/texto"]),i.video&&this.router.navigate(["/users/entrena/vercurso/verleccion/video"]),i.quiz&&this.router.navigate(["/users/entrena/vercurso/verleccion/quiz"])):(this.share.updateorder(null),this.quizHistory.length>0?this.share.guardarquices(this.quizHistory,this.token).subscribe(e=>{this.share.removerQuiz(),this.submit()},e=>{this.mostrarmensaje("Ah ocurrido un error, comuniquese con el administrador","Error","red-snackbar")}):this.submit())})}submit(){this.loadingService.loadingPresent({spinner:"circles"}),this.share.obtenerLeccionesUsuario(this.course.course_id,this.token,this.user.id).subscribe(e=>{if(this.loadingService.loadingDismiss(),e.data.find(e=>e.id_lesson===this.course.id&&e.course_id===this.course.course_id))this.share.guardarLeccionActiva(null),this.alertProgreso(),this.share.varLeciones.next(),this.router.navigateByUrl("/users/entrena/vercurso");else{const s={id_user:this.user.id,id_course:this.course.course_id,id_lesson:this.course.id};this.loadingService.loadingPresent({spinner:"circles"}),this.share.guardarleccion(s,this.token).subscribe(s=>{this.loadingService.loadingDismiss(),this.share.guardarLeccionActiva(null),this.cursoGeneral.lessons.length-1===e.data.length?(this.share.varExamen.next(),this.router.navigateByUrl("/users/entrena/vercurso/verleccion/examen")):(this.alertProgreso(),this.share.varLeciones.next(),this.router.navigateByUrl("/users/entrena/vercurso"))},e=>{this.loadingService.loadingDismiss(),this.mostrarmensaje("Ah ocurrido un error, comuniquese con el administrador","Error","red-snackbar")})}},e=>{this.loadingService.loadingDismiss()})}alertProgreso(){return Object(a.b)(this,void 0,void 0,(function*(){this.alert=yield this.alertController.create({header:"Felicidades",subHeader:"Terminaste la lecci\xf3n",message:"Pasa a la siguiente lecci\xf3n para incrementar tu progreso",buttons:["Acepto"]}),yield this.alert.present()}))}mostrarmensaje(e,s,i){this.snackbar.open(e,s,{duration:2e3,panelClass:[i]})}}return e.\u0275fac=function(s){return new(s||e)(c.Vb(h.a),c.Vb(u.a),c.Vb(d.a),c.Vb(l.a),c.Vb(b.a),c.Vb(n.h),c.Vb(o.b),c.Vb(g.a))},e.\u0275cmp=c.Pb({type:e,selectors:[["app-contenido"]],decls:6,vars:0,consts:[[1,"ion-toolbar-ccs"],[1,"tituloInfo","logo"],[2,"color","white"]],template:function(e,s){1&e&&(c.bc(0,"ion-header"),c.bc(1,"ion-toolbar",0),c.bc(2,"ion-title",1),c.bc(3,"label",2),c.Qc(4,"MAGIN"),c.ac(),c.ac(),c.ac(),c.ac(),c.Wb(5,"ion-content"))},directives:[o.y,o.db,o.cb,o.s],styles:[""]}),e})()}];let p=(()=>{class e{}return e.\u0275mod=c.Tb({type:e}),e.\u0275inj=c.Sb({factory:function(s){return new(s||e)},imports:[[n.j.forChild(v)],n.j]}),e})(),m=(()=>{class e{}return e.\u0275mod=c.Tb({type:e}),e.\u0275inj=c.Sb({factory:function(s){return new(s||e)},imports:[[t.c,r.k,o.eb,p]]}),e})()}}]);