(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{"5eqV":function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return a}));var n=i("fXoL");let s=(()=>{class t{constructor(t,e){this.element=t,this._zone=e,this.onlyGrow=!1,this.useImportant=!1,this.resized=new n.p,this.retries=0,this._destroyed=!1,"TEXTAREA"!==this.element.nativeElement.tagName?this._findNestedTextArea():(this.textAreaEl=this.element.nativeElement,this.textAreaEl.style.overflow="hidden",this._onTextAreaFound())}set minRows(t){this._minRows=t,this.textAreaEl&&(this.textAreaEl.rows=t)}onInput(t){this.adjust()}ngOnDestroy(){this._destroyed=!0,this._windowResizeHandler&&window.removeEventListener("resize",this._windowResizeHandler,!1)}ngAfterContentChecked(){this.adjust()}ngOnChanges(t){this.adjust(!0)}_findNestedTextArea(){this.textAreaEl=this.element.nativeElement.querySelector("TEXTAREA"),!this.textAreaEl&&this.element.nativeElement.shadowRoot&&(this.textAreaEl=this.element.nativeElement.shadowRoot.querySelector("TEXTAREA")),this.textAreaEl?(this.textAreaEl.style.overflow="hidden",this._onTextAreaFound()):this.retries>=3?console.warn("ngx-autosize: textarea not found"):(this.retries++,setTimeout(()=>{this._findNestedTextArea()},100))}_onTextAreaFound(){this._addWindowResizeHandler(),setTimeout(()=>{this.adjust()})}_addWindowResizeHandler(){this._windowResizeHandler=function(t,e,i=!1){let n;return function(){const s=this,a=arguments,o=function(){n=null,i||t.apply(s,a)},c=i&&!n;clearTimeout(n),n=setTimeout(o,e),c&&t.apply(s,a)}}(()=>{this._zone.run(()=>{this.adjust()})},200),this._zone.runOutsideAngular(()=>{window.addEventListener("resize",this._windowResizeHandler,!1)})}adjust(t=!1){if(!this._destroyed&&this.textAreaEl){const e=this.textAreaEl.value;if(!1===t&&e===this._oldContent&&this.textAreaEl.offsetWidth===this._oldWidth)return;this._oldContent=e,this._oldWidth=this.textAreaEl.offsetWidth;const i=this.textAreaEl.cloneNode(!0),n=this.textAreaEl.parentNode;i.style.width=this.textAreaEl.offsetWidth+"px",i.style.visibility="hidden",i.style.position="absolute",i.textContent=e,n.appendChild(i),i.style.overflow="hidden",i.style.height="auto";let s=i.scrollHeight,a=window.getComputedStyle(i,null);s+=parseInt(a.getPropertyValue("border-top-width")),s+=parseInt(a.getPropertyValue("border-bottom-width"));const o=this.textAreaEl.offsetHeight,c=s>o;if(!1===this.onlyGrow||c){const t=this._getLineHeight(),e=s/t;if(this._minRows&&this._minRows>=e)s=this._minRows*t;else if(this.maxRows&&this.maxRows<=e){const e=this.maxRows*t;s=this.onlyGrow?Math.max(e,o):e,this.textAreaEl.style.overflow="auto"}else this.textAreaEl.style.overflow="hidden";this.textAreaEl.style.setProperty("height",s+"px",this.useImportant?"important":""),this.resized.emit(s)}n.removeChild(i)}}_getLineHeight(){let t=parseInt(this.textAreaEl.style.lineHeight,10);if(isNaN(t)&&window.getComputedStyle){const e=window.getComputedStyle(this.textAreaEl);t=parseInt(e.lineHeight,10)}if(isNaN(t)){const e=window.getComputedStyle(this.textAreaEl,null).getPropertyValue("font-size");t=Math.floor(1.5*parseInt(e.replace("px",""),10))}return t}}return t.\u0275fac=function(e){return new(e||t)(n.Vb(n.m),n.Vb(n.E))},t.\u0275dir=n.Qb({type:t,selectors:[["","autosize",""]],hostBindings:function(t,e){1&t&&n.jc("input",(function(t){return e.onInput(t.target)}))},inputs:{onlyGrow:"onlyGrow",useImportant:"useImportant",minRows:"minRows",maxRows:"maxRows"},outputs:{resized:"resized"},features:[n.Gb]}),t})(),a=(()=>{class t{}return t.\u0275mod=n.Tb({type:t}),t.\u0275inj=n.Sb({factory:function(e){return new(e||t)},imports:[[]]}),t})()},yTs8:function(t,e,i){"use strict";i.r(e),i.d(e,"ChatPageModule",(function(){return L}));var n=i("ofXK"),s=i("3Pt+"),a=i("TEn/"),o=i("tyNb"),c=i("fXoL"),r=i("UsEe"),l=i("7Vn+"),d=i("8rbx"),h=i("h7Fw"),u=i("3no8"),g=i("wZkO"),f=i("cZdB");function b(t,e){if(1&t&&(c.bc(0,"ion-label",19),c.Qc(1),c.ac()),2&t){const t=c.nc();c.Ib(1),c.Rc(t.message_header)}}function m(t,e){if(1&t&&(c.bc(0,"ion-label",20),c.Qc(1),c.ac()),2&t){const t=c.nc();c.Ib(1),c.Rc(t.nameUser)}}function p(t,e){if(1&t){const t=c.cc();c.bc(0,"ion-searchbar",21),c.jc("ionChange",(function(e){return c.Hc(t),c.nc().buscar(e)})),c.ac()}if(2&t){const t=c.nc();c.uc("value",t.searhVariable)}}function x(t,e){1&t&&(c.bc(0,"ion-label",25),c.Qc(1,"Resultados encontrados:"),c.ac())}function w(t,e){1&t&&(c.bc(0,"ion-label",25),c.Qc(1,"No se encontraron resultados"),c.ac())}function v(t,e){if(1&t){const t=c.cc();c.bc(0,"ion-item",27),c.bc(1,"ion-avatar",28),c.bc(2,"img",29),c.jc("click",(function(){c.Hc(t);const i=e.$implicit;return c.nc(3).abrirMensajesBusqueda(i)})),c.ac(),c.ac(),c.bc(3,"div",30),c.jc("click",(function(){c.Hc(t);const i=e.$implicit;return c.nc(3).abrirMensajesBusqueda(i)})),c.bc(4,"div",31),c.bc(5,"ion-label",32),c.Qc(6),c.ac(),c.ac(),c.ac(),c.ac()}if(2&t){const t=e.$implicit;c.Ib(2),c.wc("src","assets/avatar/",t.avatar,".png",c.Jc),c.Ib(4),c.Tc("",t.name," ",t.lastname,"")}}function I(t,e){if(1&t&&(c.bc(0,"ion-list"),c.Oc(1,v,7,3,"ion-item",26),c.ac()),2&t){const t=c.nc(2);c.Ib(1),c.uc("ngForOf",t.data)}}function _(t,e){if(1&t&&(c.bc(0,"ion-card",22),c.Oc(1,x,2,0,"ion-label",23),c.Oc(2,w,2,0,"ion-label",23),c.Oc(3,I,2,1,"ion-list",24),c.ac()),2&t){const t=c.nc();c.Ib(1),c.uc("ngIf",t.data.length>0),c.Ib(1),c.uc("ngIf",t.textoBuscar&&!t.filterList&&0===t.data.length),c.Ib(1),c.uc("ngIf",t.data.length>0)}}function O(t,e){1&t&&(c.bc(0,"ion-card-title",33),c.bc(1,"div",34),c.Wb(2,"ion-icon",35),c.bc(3,"ion-label",36),c.Qc(4,"Chat"),c.ac(),c.ac(),c.ac())}function y(t,e){if(1&t){const t=c.cc();c.bc(0,"ion-avatar",28),c.bc(1,"img",29),c.jc("click",(function(){c.Hc(t);const e=c.nc().$implicit;return c.nc().abrirDialogo(e)})),c.ac(),c.ac()}if(2&t){const t=c.nc().$implicit;c.Ib(1),c.wc("src","assets/avatar/",t.usuario.avatar,".png",c.Jc)}}function C(t,e){if(1&t&&(c.bc(0,"ion-label",42),c.Qc(1),c.oc(2,"date"),c.ac()),2&t){const t=c.nc(2).$implicit;c.Ib(1),c.Rc(c.qc(2,1,t.messagesReceptor[t.messagesReceptor.length-1].created_at,"dd/MM/yyyy"))}}function R(t,e){if(1&t&&(c.bc(0,"ion-label",43),c.Qc(1),c.oc(2,"slice"),c.ac()),2&t){const t=c.nc(2).$implicit;c.Ib(1),c.Rc(t.messagesReceptor[t.messagesReceptor.length-1].message>50?c.rc(2,1,t.messagesReceptor[t.messagesReceptor.length-1].message,0,50)+"...":t.messagesReceptor[t.messagesReceptor.length-1].message)}}function A(t,e){if(1&t){const t=c.cc();c.bc(0,"div",30),c.jc("click",(function(){c.Hc(t);const e=c.nc().$implicit;return c.nc().abrirDialogo(e)})),c.bc(1,"div",31),c.bc(2,"ion-label",32),c.Qc(3),c.ac(),c.Oc(4,C,3,4,"ion-label",40),c.ac(),c.Oc(5,R,3,5,"ion-label",41),c.ac()}if(2&t){const t=c.nc().$implicit;c.Ib(3),c.Tc("",t.usuario.name," ",t.usuario.lastname,""),c.Ib(1),c.uc("ngIf",t.messagesReceptor.length>0),c.Ib(1),c.uc("ngIf",t.messagesReceptor.length>0)}}function E(t,e){if(1&t&&(c.bc(0,"ion-item",37),c.Oc(1,y,2,1,"ion-avatar",38),c.Oc(2,A,6,4,"div",39),c.ac()),2&t){const t=e.$implicit;c.Ib(1),c.uc("ngIf",t.usuario),c.Ib(1),c.uc("ngIf",t.usuario)}}function P(t,e){1&t&&(c.bc(0,"ion-card-title",33),c.bc(1,"div",34),c.Wb(2,"ion-icon",44),c.bc(3,"ion-label",36),c.Qc(4,"Notificaciones"),c.ac(),c.ac(),c.ac())}function z(t,e){if(1&t&&(c.bc(0,"ion-item",37),c.bc(1,"ion-avatar",46),c.Wb(2,"img",47),c.ac(),c.bc(3,"p",48),c.bc(4,"strong"),c.Qc(5,"Agregaste a "),c.bc(6,"span",49),c.Qc(7),c.ac(),c.Qc(8," como amigo."),c.ac(),c.ac(),c.ac()),2&t){const t=c.nc().$implicit;c.Ib(2),c.wc("src","../../../assets/avatar/",t.receiver.avatar,".png",c.Jc),c.Ib(5),c.Tc("",t.receiver.name,"\xa0",t.receiver.lastname,"")}}function M(t,e){if(1&t&&(c.bc(0,"ion-item",37),c.bc(1,"ion-avatar",46),c.Wb(2,"img",47),c.ac(),c.bc(3,"p",48),c.bc(4,"strong"),c.Qc(5,"El usuario "),c.bc(6,"span",49),c.Qc(7),c.ac(),c.Qc(8," te ha agregado como amigo. "),c.ac(),c.ac(),c.ac()),2&t){const t=c.nc().$implicit;c.Ib(2),c.wc("src","../../../assets/avatar/",t.transmitter.avatar,".png",c.Jc),c.Ib(5),c.Tc("",t.transmitter.name,"\xa0",t.transmitter.lastname,"")}}function j(t,e){if(1&t&&(c.bc(0,"ion-item",37),c.bc(1,"ion-avatar",46),c.Wb(2,"img",47),c.ac(),c.bc(3,"p",48),c.bc(4,"strong"),c.Qc(5,"El usuario "),c.bc(6,"span",49),c.Qc(7),c.ac(),c.Qc(8," te ha enviado un mensaje. "),c.ac(),c.ac(),c.ac()),2&t){const t=c.nc().$implicit;c.Ib(2),c.wc("src","../../../assets/avatar/",t.transmitter.avatar,".png",c.Jc),c.Ib(5),c.Tc("",t.transmitter.name,"\xa0",t.transmitter.lastname,"")}}function T(t,e){if(1&t&&(c.bc(0,"ion-list"),c.Oc(1,z,9,3,"ion-item",45),c.Oc(2,M,9,3,"ion-item",45),c.Oc(3,j,9,3,"ion-item",45),c.ac()),2&t){const t=e.$implicit,i=c.nc();c.Ib(1),c.uc("ngIf",i.idUser==t.transmitter.id&&t.receiver),c.Ib(1),c.uc("ngIf",i.idUser!==t.transmitter.id&&t.transmitter),c.Ib(1),c.uc("ngIf",i.idUser!==t.transmitter.id&&t.transmitter)}}const S=[{path:"",component:(()=>{class t{constructor(t,e,i,n,s,a){this.router=t,this.chatS=e,this.auth=i,this.log=n,this.pObjecto=s,this.loadingService=a,this.userList=[],this.textoBuscar="",this.userTk=null,this.filterList="",this.notifications=!1,this.textoBuscar="",this.filterList="",this.getToken(),this.getCurrentHour()}ngOnInit(){this.data=[],this.userList=[]}getToken(){this.auth.gettokenLog().then(t=>{this.token=t,this.getUserAuth(),this.chatS.removeNotification(),this.chatS.var.next("token remove")})}getCurrentHour(){var t=(new Date).getHours();this.message_header=t<12?"Buenos d\xedas":t<18?"Buenas tardes":"Buenas noches"}getUserAuth(){this.auth.gettokenLog().then(t=>{this.userTk=t,this.loadingService.loadingPresent({spinner:"circles"}),this.log.logdataInfData(t).subscribe(t=>{this.loadingService.loadingDismiss(),this.idUser=t.id,this.nameUser=t.name,this.getUsersChats()},t=>{this.loadingService.loadingDismiss()})})}getUsersChats(){this.loadingService.loadingPresent({spinner:"circles"}),this.chatS.getchatsUser(this.idUser,this.token).subscribe(t=>{t.data.map(t=>{t.usuario=t.receiver_id===this.idUser?t.transmitter:t.receiver,t.messagesReceptor=t.messages.filter(t=>t.user_id!==this.idUser),this.userList.push(t)}),this.userList=this.userList.sort((t,e)=>{if(t.messagesReceptor.length>0&&e.messagesReceptor.length>0)return 0-(new Date(t.messagesReceptor[t.messagesReceptor.length-1].updated_at).getTime()<new Date(e.messagesReceptor[e.messagesReceptor.length-1].updated_at).getTime()?-1:1)}),this.loadingService.loadingDismiss()},t=>{this.loadingService.loadingDismiss()})}buscar(t){this.filterList="",this.textoBuscar=t.detail.value,""!=this.textoBuscar?(this.loadingService.loadingPresent({spinner:"circles"}),this.chatS.getAllUsers(this.textoBuscar,this.token).subscribe(t=>{t.data.length>0&&(this.data=t.data.filter(t=>t.id!==this.idUser),this.chatS.var.next("User find")),this.loadingService.loadingDismiss()},t=>{this.loadingService.loadingDismiss()})):this.data=[]}closeSearch(){this.textoBuscar="",this.filterList="",this.data=[]}selectedIndexChange(t){0===t?this.notifications=!1:(this.notifications=!0,this.closeSearch())}abrirDialogo(t){this.data=[],this.pObjecto.setData({infoDt:t,transferID:this.idUser,useractual:this.nameUser}),this.router.navigate(["/users/chat/enviomsj"])}abrirMensajesBusqueda(t){this.data=[],this.pObjecto.setData({infoDt:t,transferID:this.idUser,useractual:this.nameUser}),this.router.navigate(["/users/chat/mensaje-busqueda"])}}return t.\u0275fac=function(e){return new(e||t)(c.Vb(o.h),c.Vb(r.a),c.Vb(l.a),c.Vb(d.a),c.Vb(h.a),c.Vb(u.a))},t.\u0275cmp=c.Pb({type:t,selectors:[["app-chat"]],decls:27,vars:9,consts:[["header",""],[1,"ion-toolbar-ccs"],["toolbar",""],[1,"logo"],["size","4"],[1,"icon-header"],["src","/assets/finallogo.png","width","120","height","70"],["size","8",2,"align-self","flex-end"],[1,"info-header"],["style","font-size: 14px;color: #fff;margin-right: 5px;",4,"ngIf"],["style","font-size: 14px;color: #fff;text-transform: capitalize;",4,"ngIf"],["placeholder","Busca m\xe1s miembros de la comunidad MAGIN","animated","","style","padding: 0;",3,"value","ionChange",4,"ngIf"],["style","margin: 5px 0px;",4,"ngIf"],["mat-stretch-tabs","",1,"example-stretched-tabs","mat-elevation-z4",3,"selectedIndexChange"],["mat-tab-label",""],[2,"padding","0"],["class","friend",4,"ngFor","ngForOf"],[1,"container"],[4,"ngFor","ngForOf"],[2,"font-size","14px","color","#fff","margin-right","5px"],[2,"font-size","14px","color","#fff","text-transform","capitalize"],["placeholder","Busca m\xe1s miembros de la comunidad MAGIN","animated","",2,"padding","0",3,"value","ionChange"],[2,"margin","5px 0px"],["class","label-results",4,"ngIf"],[4,"ngIf"],[1,"label-results"],["class","container friend",4,"ngFor","ngForOf"],[1,"container","friend"],["slot","start"],[3,"src","click"],[1,"user-list",3,"click"],[2,"display","flex","width","100%"],["color","primary",1,"label-user-chat"],[1,"title-css"],[2,"display","flex","align-items","center","font-size","18px"],["name","chatbubbles"],[2,"margin-left","10px"],[1,"friend"],["slot","start",4,"ngIf"],["class","user-list",3,"click",4,"ngIf"],["class","label-date",4,"ngIf"],["class","label-message",4,"ngIf"],[1,"label-date"],[1,"label-message"],["name","notifications"],["class","friend",4,"ngIf"],["slot","start",1,"author-image"],[1,"imagestyle",3,"src"],[1,"user-list"],[2,"color","black","font-size","15px","text-transform","capitalize"]],template:function(t,e){1&t&&(c.bc(0,"ion-header",null,0),c.bc(2,"ion-toolbar",1,2),c.bc(4,"div"),c.bc(5,"ion-toolbar"),c.bc(6,"ion-row",3),c.bc(7,"ion-col",4),c.bc(8,"div",5),c.Wb(9,"img",6),c.ac(),c.ac(),c.bc(10,"ion-col",7),c.bc(11,"div",8),c.Oc(12,b,2,1,"ion-label",9),c.Oc(13,m,2,1,"ion-label",10),c.ac(),c.ac(),c.ac(),c.ac(),c.ac(),c.ac(),c.ac(),c.bc(14,"ion-content"),c.Oc(15,p,1,1,"ion-searchbar",11),c.Oc(16,_,4,3,"ion-card",12),c.bc(17,"mat-tab-group",13),c.jc("selectedIndexChange",(function(t){return e.selectedIndexChange(t)})),c.bc(18,"mat-tab"),c.Oc(19,O,5,0,"ng-template",14),c.bc(20,"ion-list",15),c.Oc(21,E,3,2,"ion-item",16),c.oc(22,"filter"),c.ac(),c.ac(),c.bc(23,"mat-tab"),c.Oc(24,P,5,0,"ng-template",14),c.bc(25,"div",17),c.Oc(26,T,4,3,"ion-list",18),c.ac(),c.ac(),c.ac(),c.ac()),2&t&&(c.Ib(12),c.uc("ngIf",e.nameUser),c.Ib(1),c.uc("ngIf",e.nameUser),c.Ib(2),c.uc("ngIf",!e.notifications),c.Ib(1),c.uc("ngIf",!e.notifications),c.Ib(5),c.uc("ngForOf",c.qc(22,6,e.userList,e.filterList)),c.Ib(5),c.uc("ngForOf",e.userList))},directives:[a.y,a.db,a.P,a.r,n.m,a.s,g.b,g.a,g.c,a.G,n.l,a.F,a.Q,a.pb,a.l,a.E,a.f,a.p,a.z],pipes:[f.a,n.f,n.u],styles:[".user-list[_ngcontent-%COMP%]{color:#00008b;font-size:16px;width:100%}.ion-item-css[_ngcontent-%COMP%]{background-color:#fff;border:none;color:#fff;text-decoration:none;font-size:13px;width:85%;border:2px solid hsla(0,0%,100%,.4745098039215686);transition:all .3s ease-in-out;height:55px;text-align:center;margin:0 auto 10px;border-radius:8px;--background:#fff!important}.Subtitle-cs-desc[_ngcontent-%COMP%]{font-family:Century Gothic;font-size:7px;line-height:12px;margin:0;padding:7px;text-transform:uppercase;letter-spacing:1px;text-align:justify}.Subtitle-cs-desc[_ngcontent-%COMP%], .title-css[_ngcontent-%COMP%]{font-weight:700;color:#080808}.title-css[_ngcontent-%COMP%]{padding:0;line-height:44px}.friend[_ngcontent-%COMP%]{margin-bottom:10px}.friend[_ngcontent-%COMP%]:hover{background:#f1f4f6;cursor:pointer}.friend[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:50%;position:absolute;top:5px;left:10px;border:2px solid #fff}.friend[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:15px 0 0;float:left;width:220px}.friend[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:600;font-size:15px;color:#597a96}.friend[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;font-weight:400;color:#aab8c2}.titlefriends[_ngcontent-%COMP%]{text-align:center;color:#597a96}.container[_ngcontent-%COMP%]{padding:0}.author-block[_ngcontent-%COMP%]{color:#717a84}.author-image[_ngcontent-%COMP%]{border-radius:50%}*[_ngcontent-%COMP%]{font-family:Proxima Nova!important}.icon-search[_ngcontent-%COMP%]{color:#fff;margin:5px 15px 0 0}.label-user-chat[_ngcontent-%COMP%]{text-transform:capitalize;font-size:16px;width:100%}.label-date[_ngcontent-%COMP%]{width:50%;-moz-text-align-last:end;text-align-last:end;font-size:11px;color:#6b6b6b}.label-message[_ngcontent-%COMP%]{font-size:13px;color:#6b6b6b}.mat-elevation-z4[_ngcontent-%COMP%]{box-shadow:none!important}.label-results[_ngcontent-%COMP%]{padding:0 25px;font-weight:700}"]}),t})()},{path:"enviomsj",loadChildren:()=>i.e(26).then(i.bind(null,"/2d/")).then(t=>t.EnviomsjPageModule)},{path:"mensaje-busqueda",loadChildren:()=>i.e(27).then(i.bind(null,"nxSX")).then(t=>t.MensajeBusquedaPageModule)}];let k=(()=>{class t{}return t.\u0275mod=c.Tb({type:t}),t.\u0275inj=c.Sb({factory:function(e){return new(e||t)},imports:[[o.j.forChild(S)],o.j]}),t})();var U=i("5eqV"),H=i("HsBR");let L=(()=>{class t{}return t.\u0275mod=c.Tb({type:t}),t.\u0275inj=c.Sb({factory:function(e){return new(e||t)},imports:[[n.c,s.k,a.eb,k,U.b,H.a,g.d]]}),t})()}}]);