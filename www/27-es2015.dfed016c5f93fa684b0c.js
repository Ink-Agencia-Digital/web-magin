(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{nxSX:function(t,n,e){"use strict";e.r(n),e.d(n,"MensajeBusquedaPageModule",(function(){return w}));var i=e("ofXK"),o=e("3Pt+"),a=e("TEn/"),s=e("tyNb"),c=e("fXoL"),r=e("UsEe"),d=e("h7Fw"),l=e("7Vn+"),g=e("RnZ8"),h=e("3no8");function b(t,n){if(1&t&&(c.bc(0,"ion-item"),c.Wb(1,"ion-icon",16),c.bc(2,"ion-label",17),c.Qc(3),c.ac(),c.ac()),2&t){const t=c.nc(2);c.Ib(3),c.Tc("",t.data.name,"\xa0",t.data.lastname,"")}}function m(t,n){if(1&t&&(c.bc(0,"div"),c.Oc(1,b,4,2,"ion-item",7),c.ac()),2&t){const t=c.nc();c.Ib(1),c.uc("ngIf",t.transmiterID!==t.data.id)}}function u(t,n){if(1&t&&(c.bc(0,"div",20),c.bc(1,"span",21),c.Qc(2),c.ac(),c.bc(3,"div",22),c.Qc(4),c.oc(5,"date"),c.ac(),c.ac()),2&t){const t=c.nc().$implicit;c.Ib(2),c.Rc(t.message),c.Ib(2),c.Rc(c.qc(5,2,t.created_at,"short"))}}function f(t,n){if(1&t&&(c.bc(0,"div",23),c.bc(1,"div",24),c.Qc(2),c.ac(),c.bc(3,"div",25),c.Qc(4),c.oc(5,"date"),c.ac(),c.ac()),2&t){const t=c.nc().$implicit;c.Ib(2),c.Rc(t.message),c.Ib(2),c.Rc(c.qc(5,2,t.created_at,"short"))}}function p(t,n){if(1&t&&(c.bc(0,"div"),c.Oc(1,u,6,5,"div",18),c.Oc(2,f,6,5,"div",19),c.ac()),2&t){const t=n.$implicit,e=c.nc();c.Ib(1),c.uc("ngIf",e.transmiterID!==t.user_id),c.Ib(1),c.uc("ngIf",e.transmiterID===t.user_id)}}const x=[{path:"",component:(()=>{class t{constructor(t,n,e,i,o,a){this.router=t,this.chatS=n,this.pObjecto=e,this.auth=i,this.pusher=o,this.loadingService=a,this.newMsg=null,this.getToken()}ngOnInit(){}getToken(){this.auth.gettokenLog().then(t=>{this.token=t,this.loadPage()})}loadPage(){let t=this.pObjecto.getNavData();t&&(this.data=t.infoDt,this.transmiterID=t.transferID,this.usuarioActual=t.useractual,this.pusher.channelsuscribe(this.data.id),this.pusher.init().bind("chat_event",t=>{this.updateMsg(t)}),this.idChat&&this.chatS.var.subscribe(t=>{this.chatS.getchatsMSGUser(this.idChat,this.token).subscribe(t=>{this.menjs=t.data,setTimeout(()=>{this.content.scrollToBottom(200)})})}))}updateMsg(t){this.menjs.push(t.message),this.content.scrollToBottom(100)}enviarMsg(){this.newMsg&&(this.loadingService.loadingPresent({spinner:"circles"}),this.chatS.crearChat(this.transmiterID,this.data.id,this.token).subscribe(t=>{this.idChat=t.data.id,this.chatS.enviarMensajeChat(t.data.id,this.transmiterID,this.newMsg,this.token).subscribe(n=>{this.chatS.getchatsMSGUser(t.data.id,this.token).subscribe(t=>{this.menjs=t.data,this.chatS.var.next("update mgs"),setTimeout(()=>{this.content.scrollToBottom()}),this.loadingService.loadingDismiss()},t=>{this.loadingService.loadingDismiss()}),this.newMsg=null},t=>{this.loadingService.loadingDismiss()})},t=>{this.loadingService.loadingDismiss()}))}volver(){this.router.navigate(["/users/chat"])}}return t.\u0275fac=function(n){return new(n||t)(c.Vb(s.h),c.Vb(r.a),c.Vb(d.a),c.Vb(l.a),c.Vb(g.a),c.Vb(h.a))},t.\u0275cmp=c.Pb({type:t,selectors:[["app-mensaje-busqueda"]],viewQuery:function(t,n){var e;1&t&&c.Wc(a.s,!0),2&t&&c.Dc(e=c.kc())&&(n.content=e.first)},decls:22,vars:4,consts:[[1,"ion-toolbar-ccs"],["slot","start",2,"color","white"],[3,"click"],["name","arrow-back"],[1,"tituloInfo","logo"],[2,"color","white"],[1,"message-wrap"],[4,"ngIf"],[1,"message"],[4,"ngFor","ngForOf"],[1,"ion-align-items-center","ion-no-padding"],["size","10"],["autosize","","maxRow","4","placeholder","Escribe un mensaje",1,"msg-input",3,"ngModel","ngModelChange"],["size","2",1,"send"],["expand","block",1,"msg-btn",3,"disabled","click"],["name","send-outline"],["name","person-circle-outline",2,"color","black"],[2,"margin-left","5px",";text-transform","capitalize","font-size","20px"],["class","message other-message left",4,"ngIf"],["class","message my-message right",4,"ngIf"],[1,"message","other-message","left"],[2,"color","white","font-size","16px"],[1,"ion-text-left",2,"color","#ffffff","font-size","11px","margin-right","15px"],[1,"message","my-message","right"],[1,"ion-text-right",2,"color","white","font-size","16px"],[1,"time","ion-text-right",2,"color","white","font-size","11px"]],template:function(t,n){1&t&&(c.bc(0,"ion-header"),c.bc(1,"ion-toolbar",0),c.bc(2,"ion-buttons",1),c.bc(3,"ion-button",2),c.jc("click",(function(){return n.volver()})),c.Wb(4,"ion-icon",3),c.ac(),c.ac(),c.bc(5,"ion-title",4),c.bc(6,"label",5),c.Qc(7,"MAGIN"),c.ac(),c.ac(),c.ac(),c.ac(),c.bc(8,"ion-content",6),c.bc(9,"ion-header"),c.Oc(10,m,2,1,"div",7),c.ac(),c.bc(11,"div",8),c.Oc(12,p,3,2,"div",9),c.ac(),c.ac(),c.bc(13,"ion-footer"),c.bc(14,"ion-toolbar"),c.bc(15,"ion-row",10),c.bc(16,"ion-col",11),c.bc(17,"textarea",12),c.jc("ngModelChange",(function(t){return n.newMsg=t})),c.Qc(18,"        "),c.ac(),c.ac(),c.bc(19,"ion-col",13),c.bc(20,"button",14),c.jc("click",(function(){return n.enviarMsg()})),c.Wb(21,"ion-icon",15),c.ac(),c.ac(),c.ac(),c.ac(),c.ac()),2&t&&(c.Ib(10),c.uc("ngIf",n.data),c.Ib(2),c.uc("ngForOf",n.menjs),c.Ib(5),c.uc("ngModel",n.newMsg),c.Ib(3),c.uc("disabled",!n.newMsg))},directives:[a.y,a.db,a.k,a.j,a.z,a.cb,a.s,i.m,i.l,a.w,a.P,a.r,o.c,o.p,o.s,a.E,a.F],pipes:[i.f],styles:[".mensaje[_ngcontent-%COMP%]{padding:10px;border-radius:10px;margin-bottom:4px;white-space:pre-wrap}.usuarios[_ngcontent-%COMP%]{background:var(--ion-color-tertiary);color:#fff}.mi-usuarios[_ngcontent-%COMP%]{color:#fff;background-color:#8bc34a;text-align:right}.time[_ngcontent-%COMP%]{color:#dfdfdf;float:right;font-size:small;margin-left:15px}.msg-input[_ngcontent-%COMP%]{width:100%;border:1px solid #d4d4d4;border-radius:6px;background:#fff;resize:none;margin-top:0;--padding-start:8px}.msg-btn[_ngcontent-%COMP%]{font-size:30px;color:#fff;background-color:transparent;margin:5px 0 0 5px}*[_ngcontent-%COMP%]{font-family:Proxima Nova!important}.send[_ngcontent-%COMP%]{background:#002a68;-moz-text-align-last:center;text-align-last:center;border-radius:90%;height:50px;max-width:55px!important}.message[_ngcontent-%COMP%]{padding:9px!important;border-radius:10px!important;margin-bottom:8px!important;white-space:pre-wrap;display:block}.other-message.left[_ngcontent-%COMP%]{float:left;background-color:#2196f3!important;border:1px solid #d4d4d4;margin-right:35%!important;color:#fff}.my-message.right[_ngcontent-%COMP%]{float:right;background-color:#8bc34a!important;color:#000!important;border:1px solid #d6d6d6;margin-left:35%!important}"]}),t})()}];let v=(()=>{class t{}return t.\u0275mod=c.Tb({type:t}),t.\u0275inj=c.Sb({factory:function(n){return new(n||t)},imports:[[s.j.forChild(x)],s.j]}),t})(),w=(()=>{class t{}return t.\u0275mod=c.Tb({type:t}),t.\u0275inj=c.Sb({factory:function(n){return new(n||t)},imports:[[i.c,o.k,a.eb,v]]}),t})()}}]);