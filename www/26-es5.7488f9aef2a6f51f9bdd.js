function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{"/2d/":function(t,e,n){"use strict";n.r(e),n.d(e,"EnviomsjPageModule",(function(){return _}));var i=n("ofXK"),o=n("3Pt+"),a=n("TEn/"),c=n("tyNb"),s=n("fXoL"),r=n("UsEe"),l=n("7Vn+"),d=n("8rbx"),u=n("h7Fw"),g=n("RnZ8"),f=n("3no8"),h=n("5eqV");function b(t,e){if(1&t&&(s.bc(0,"ion-item"),s.Wb(1,"ion-icon",18),s.bc(2,"ion-label",19),s.Qc(3),s.ac(),s.ac()),2&t){var n=s.nc(2);s.Ib(3),s.Tc("",n.data.transmitter.name,"\xa0",n.data.transmitter.lastname,"")}}function m(t,e){if(1&t&&(s.bc(0,"ion-item"),s.Wb(1,"ion-icon",18),s.bc(2,"ion-label",19),s.Qc(3),s.ac(),s.ac()),2&t){var n=s.nc(2);s.Ib(3),s.Tc("",n.data.receiver.name,"\xa0",n.data.receiver.lastname,"")}}function p(t,e){if(1&t&&(s.bc(0,"div"),s.Oc(1,b,4,2,"ion-item",7),s.Oc(2,m,4,2,"ion-item",7),s.ac()),2&t){var n=s.nc();s.Ib(1),s.uc("ngIf",n.transmiterID===n.data.receiver.id),s.Ib(1),s.uc("ngIf",n.transmiterID!==n.data.receiver.id)}}function v(t,e){if(1&t&&(s.bc(0,"div",22),s.bc(1,"span"),s.Qc(2),s.ac(),s.bc(3,"div",23),s.Qc(4),s.oc(5,"date"),s.ac(),s.ac()),2&t){var n=s.nc().$implicit;s.Ib(2),s.Rc(n.message),s.Ib(2),s.Rc(s.qc(5,2,n.created_at,"short"))}}function k(t,e){if(1&t&&(s.bc(0,"div",24),s.bc(1,"div",25),s.Qc(2),s.ac(),s.bc(3,"div",26),s.Qc(4),s.oc(5,"date"),s.ac(),s.ac()),2&t){var n=s.nc().$implicit;s.Ib(2),s.Rc(n.message),s.Ib(2),s.Rc(s.qc(5,2,n.created_at,"short"))}}function x(t,e){if(1&t&&(s.bc(0,"div"),s.Oc(1,v,6,5,"div",20),s.Oc(2,k,6,5,"div",21),s.ac()),2&t){var n=e.$implicit,i=s.nc();s.Ib(1),s.uc("ngIf",i.transmiterID!==n.user_id),s.Ib(1),s.uc("ngIf",i.transmiterID===n.user_id)}}var I,w,M,y=[{path:"",component:(I=function(){function t(e,n,i,o,a,c,s){_classCallCheck(this,t),this.router=e,this.chatS=n,this.auth=i,this.log=o,this.pObjecto=a,this.pusher=c,this.loadingService=s,this.newMsg="",this.menjs=[],this.scrollBottom=!0,this.usertk=null,this.getToken()}return _createClass(t,[{key:"ngAfterViewChecked",value:function(){this.scrollToBottom()}},{key:"getToken",value:function(){var t=this;this.auth.gettokenLog().then((function(e){t.token=e,t.loadPage()}))}},{key:"scrollToBottom",value:function(){15===this.menjs.length&&(this.content.scrollToBottom(),this.scrollBottom=!0)}},{key:"ngOnInit",value:function(){}},{key:"loadPage",value:function(){var t=this;this.getAuhUser();var e=this.pObjecto.getNavData();e&&(this.data=e.infoDt,this.chatId=e.infoDt.id,this.transmiterID=e.transferID,this.usuarioActual=e.useractual,this.pusher.channelsuscribe(this.data.id),this.pusher.init().bind("chat_event",(function(e){t.updateMsg(e)})),this.loadMessages(),this.userList=this.data)}},{key:"getAuhUser",value:function(){var t=this;this.auth.gettokenLog().then((function(e){t.log.logdataInfData(e).subscribe((function(e){t.usertk=e}))}))}},{key:"loadMessages",value:function(){var t=this;this.loadingService.loadingPresent({spinner:"circles"}),this.data.id&&this.chatS.getchatsMSGUser(this.data.id,this.token).subscribe((function(e){t.total=e.meta,t.menjs=e.data,t.page=t.total.current_page+1,t.loadingService.loadingDismiss()}),(function(e){t.loadingService.loadingDismiss()}))}},{key:"loadData",value:function(t){var e=this;setTimeout((function(){e.data.id&&(e.menjs.length!==e.total?e.chatS.getMessageOFPages(e.data.id,e.page,e.token).subscribe((function(n){n.data.forEach((function(t){e.menjs.unshift(t)})),t.target.complete()})):t.target.disabled=!0)}),1e3)}},{key:"updateMsg",value:function(t){this.menjs.push(t.message),this.content.scrollToBottom(100)}},{key:"enviarMsg",value:function(){var t=this;this.chatId&&(this.loadingService.loadingPresent({spinner:"circles"}),this.chatS.enviarMensajeChat(this.chatId,this.transmiterID,this.newMsg,this.token).subscribe((function(e){t.chatS.getchatsMSGUser(t.chatId,t.token).subscribe((function(e){t.chatS.var.next("update messages"),setTimeout((function(){t.content.scrollToBottom(200)}))})),t.newMsg="",t.loadingService.loadingDismiss()}),(function(e){t.loadingService.loadingDismiss()})))}},{key:"volver",value:function(){this.router.navigate(["/users/chat"])}}]),t}(),I.\u0275fac=function(t){return new(t||I)(s.Vb(c.h),s.Vb(r.a),s.Vb(l.a),s.Vb(d.a),s.Vb(u.a),s.Vb(g.a),s.Vb(f.a))},I.\u0275cmp=s.Pb({type:I,selectors:[["app-enviomsj"]],viewQuery:function(t,e){var n;1&t&&s.Wc(a.s,!0),2&t&&s.Dc(n=s.kc())&&(e.content=n.first)},decls:23,vars:4,consts:[[1,"ion-toolbar-ccs"],["slot","start",2,"color","white"],[3,"click"],["name","arrow-back"],[1,"tituloInfo","logo"],[2,"color","white"],[1,"message-wrap"],[4,"ngIf"],[1,"message"],[4,"ngFor","ngForOf"],["threshold","100px","position","bottom",3,"ionInfinite"],["loadingSpinner","bubbles","loadingText","Cargando Mensajes..."],[1,"ion-align-items-center","ion-no-padding"],["size","10"],["autosize","","maxRow","4","placeholder","Escribe un mensaje",1,"msg-input",2,"background","white",3,"ngModel","ngModelChange"],["size","2",1,"send"],["expand","block",1,"msg-btn",3,"disabled","click"],["name","send-outline"],["name","person-circle-outline",2,"color","black"],[2,"margin-left","5px",";text-transform","capitalize","font-size","20px"],["class","message other-message left",4,"ngIf"],["class","message my-message right",4,"ngIf"],[1,"message","other-message","left"],[1,"ion-text-left",2,"color","#ffffff","font-size","11px","margin-right","15px"],[1,"message","my-message","right"],[1,"ion-text-right",2,"color","white","font-size","17px"],[1,"time","ion-text-right",2,"color","white","font-size","11px"]],template:function(t,e){1&t&&(s.bc(0,"ion-header"),s.bc(1,"ion-toolbar",0),s.bc(2,"ion-buttons",1),s.bc(3,"ion-button",2),s.jc("click",(function(){return e.volver()})),s.Wb(4,"ion-icon",3),s.ac(),s.ac(),s.bc(5,"ion-title",4),s.bc(6,"label",5),s.Qc(7,"MAGIN"),s.ac(),s.ac(),s.ac(),s.ac(),s.bc(8,"ion-content",6),s.bc(9,"ion-header"),s.Oc(10,p,3,2,"div",7),s.ac(),s.bc(11,"div",8),s.Oc(12,x,3,2,"div",9),s.ac(),s.bc(13,"ion-infinite-scroll",10),s.jc("ionInfinite",(function(t){return e.loadData(t)})),s.Wb(14,"ion-infinite-scroll-content",11),s.ac(),s.ac(),s.bc(15,"ion-footer"),s.bc(16,"ion-toolbar"),s.bc(17,"ion-row",12),s.bc(18,"ion-col",13),s.bc(19,"textarea",14),s.jc("ngModelChange",(function(t){return e.newMsg=t})),s.ac(),s.ac(),s.bc(20,"ion-col",15),s.bc(21,"button",16),s.jc("click",(function(){return e.enviarMsg()})),s.Wb(22,"ion-icon",17),s.ac(),s.ac(),s.ac(),s.ac(),s.ac()),2&t&&(s.Ib(10),s.uc("ngIf",e.data),s.Ib(2),s.uc("ngForOf",e.menjs),s.Ib(7),s.uc("ngModel",e.newMsg),s.Ib(2),s.uc("disabled",""===e.newMsg))},directives:[a.y,a.db,a.k,a.j,a.z,a.cb,a.s,i.m,i.l,a.B,a.C,a.w,a.P,a.r,o.c,h.a,o.p,o.s,a.E,a.F],pipes:[i.f],styles:["*[_ngcontent-%COMP%]{font-family:Proxima Nova!important}span[_ngcontent-%COMP%]{font-size:16px}.usuarios[_ngcontent-%COMP%]{background:var(--ion-color-tertiary);color:#fff}.mi-usuarios[_ngcontent-%COMP%]{background:var(--ion-color-secondary);color:#fff}.friend-img[_ngcontent-%COMP%]{position:absolute;border-radius:40px;width:40px;height:40px;box-shadow:0 0 15px rgba(0,0,0,.5)}.message[_ngcontent-%COMP%]{padding:9px!important;border-radius:10px!important;margin-bottom:8px!important;white-space:pre-wrap;display:block}.my-message.right[_ngcontent-%COMP%]{float:right;background-color:#8bc34a!important;color:#000!important;border:1px solid #d6d6d6;margin-left:35%!important}.other-message.left[_ngcontent-%COMP%]{float:left;background-color:#2196f3!important;border:1px solid #d4d4d4;margin-right:35%!important;color:#fff}.time[_ngcontent-%COMP%]{color:#dfdfdf;float:right;font-size:small;margin-left:15px}.msg-input[_ngcontent-%COMP%]{width:100%;border-radius:6px;border:1px solid #dedede;resize:none;margin-top:0;--padding-start:8px}.msg-btn[_ngcontent-%COMP%]{font-size:25px;color:#fff;background-color:transparent;margin:7px 0 0 4px}.send[_ngcontent-%COMP%]{background:#002a68;-moz-text-align-last:center;text-align-last:center;border-radius:90%;height:50px;max-width:50px!important}"]}),I)}],C=((M=function t(){_classCallCheck(this,t)}).\u0275mod=s.Tb({type:M}),M.\u0275inj=s.Sb({factory:function(t){return new(t||M)},imports:[[c.j.forChild(y)],c.j]}),M),_=((w=function t(){_classCallCheck(this,t)}).\u0275mod=s.Tb({type:w}),w.\u0275inj=s.Sb({factory:function(t){return new(t||w)},imports:[[a.eb,i.c,o.k,h.b,C]]}),w)}}]);